/* 이론
1.
원자성
완전 함수적 종속
이행적 종속 제거

2.
제1정규화
제2정규화

3.
inner join
left join
right join
outer join

4.
반정규화

5.
인덱스
인덱스
인덱스
인덱스

6.
트랜잭션
원자성
일관성
*/



--1-1
CREATE TABLE DEPT_TEST
 AS (SELECT * FROM DEPT);
 
INSERT INTO DEPT_TEST 
 VALUES(50, 'ORACLE', 'BUSAN');
INSERT INTO DEPT_TEST 
 VALUES(60, 'SQL', 'ILSAN');
INSERT INTO DEPT_TEST 
 VALUES(70, 'SELECT', 'INCHEON');
INSERT INTO DEPT_TEST 
 VALUES(80, 'DML', 'BUNDANG');
 
SELECT * FROM dept_test;

--1-2
CREATE TABLE EMP_TEST
 AS (SELECT * FROM EMP);
 
TRUNCATE TABLE EMP_TEST;

INSERT INTO EMP_TEST 
 VALUES(7201, 'TEST_USER1', 'MANAGER', 7788, '2016-01-02',4500, NULL, 40);
INSERT INTO EMP_TEST 
 VALUES(7202, 'TEST_USER2', 'CLERK', 7201, '2016-02-21',1800, NULL, 40);
INSERT INTO EMP_TEST 
 VALUES(7203, 'TEST_USER3', 'ANALYST', 7201, '2016-04-11',3400, NULL, 40);
INSERT INTO EMP_TEST 
 VALUES(7204, 'TEST_USER4', 'SALESMAN', 7201, '2016-05-31',2700, NULL, 40);
INSERT INTO EMP_TEST 
 VALUES(7205, 'TEST_USER5', 'CLERK', 7201, '2016-07-20',2600, NULL, 40);
INSERT INTO EMP_TEST 
 VALUES(7206, 'TEST_USER6', 'CLERK', 7201, '2016-09-08',2600, NULL, 40);
INSERT INTO EMP_TEST 
 VALUES(7207, 'TEST_USER7', 'LECTURER', 7201, '2016-10-28',2300, NULL, 40);
INSERT INTO EMP_TEST 
 VALUES(7208, 'TEST_USER8', 'STUDENT', 7201, '2018-03-09',1200, NULL, 40);

SELECT *
FROM emp_test;

--1-3
UPDATE EMP_TEST 
   SET DEPTNO = 70 
 WHERE SAL > (SELECT AVG(SAL) FROM EMP_TEST WHERE DEPTNO = 50);

--1-4
UPDATE EMP_TEST 
   SET DEPTNO = 80, SAL = SAL*1.2
 WHERE EXTRACT(YEAR FROM HIREDATE) > (SELECT MIN(EXTRACT(YEAR FROM HIREDATE)) FROM EMP_TEST WHERE DEPTNO = 60);

--2-1
CREATE TABLE EMP_USER(
	EMPNO		NUMBER(5),
	ENAME		VARCHAR2(20),
	JOB			VARCHAR2(10),
	MGR			NUMBER(5),
	HIREDATE	DATE,
	SAL			NUMBER(7,2),
	DEPTNO		NUMBER(2)
);

--2-2
ALTER TABLE EMP_USER
 ADD RESIGN_DATE DATE;

--2-3
ALTER TABLE EMP_USER
 ADD SUR_NAME VARCHAR2(5);
 
--2-4
ALTER TABLE EMP_USER
 MODIFY SUR_NAME VARCHAR2(10);
 
--2-5
ALTER TABLE EMP_USER
 RENAME COLUMN ENAME TO FULL_NAME;
 
--3-1
CREATE TABLE EMP_IDX
 AS (SELECT * FROM EMP);
 
CREATE INDEX emp_empno_idx
 ON emp_idx(empno);
 
--3-2
SELECT *
FROM USER_INDEXES
WHERE index_name = 'emp_empno_idx';

--3-3
CREATE OR REPLACE VIEW emp_view AS
SELECT EMPNO, ENAME, JOB, SAL,
       NVL2(COMM, 'Y', 'N') AS COMM_YN
FROM EMP_IDX
WHERE SAL >= 20000;

/* 4
 * 4-1. 제약조건(Constraints)
 * 4-2. Unique
 * 4-3. Not Null
 * 4-4. Primary Key
 * 4-5. Foreign Key
 */
